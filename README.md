# Project Title

## Описание

Этот проект предназначен для обработки и анализа данных, включая сортировку записей по дате и фильтрацию записей по статусу. В проекте реализована структура по методологии **GitFlow** для удобной работы с несколькими ветками и совместной разработки. Основные функции реализованы в модуле `processing` внутри директории `src`.

## Функциональность

Проект включает в себя:

1. **Создание и управление ветками Git по GitFlow.**
2. **Загрузка проекта в удалённый репозиторий GitHub** для возможности командной работы.
3. **Реализация функций для обработки данных**:
   - `sort_by_date`: сортирует список словарей по дате.
   - `filter_by_state`: фильтрует список словарей по заданному статусу.

## Установка и настройка

1. **Клонирование репозитория**
   
   Сначала клонируйте репозиторий с GitHub на локальную машину:

   ```bash
   git clone <URL репозитория>
   cd <имя директории>
   ```

2. **Создание веток для работы по GitFlow**

   Для работы над различными частями проекта создайте новые ветки:

   ```bash
   git checkout -b feature/<название фичи>
   ```

3. **Подготовка репозитория**

   После создания локального репозитория добавьте файлы:

   ```bash
   git add .
   ```

   Затем сделайте коммит с описанием изменений:

   ```bash
   git commit -m "Описание изменений"
   ```

   После коммита изменения отправляются в удалённый репозиторий:

   ```bash
   git push origin <имя ветки>
   ```

## Описание модулей

### Модуль `processing`

В модуле `processing`, расположенном в директории `src`, реализованы две основные функции:

- **sort_by_date(data: list, reverse: bool = True) -> list**

  Функция принимает список словарей, каждый из которых содержит ключ `date` (дата записи). Функция сортирует записи по дате в порядке убывания (по умолчанию). Опционально можно изменить порядок сортировки, передав параметр `reverse=False`.

- **filter_by_state(data: list, state: str = 'EXECUTED') -> list**

  Функция принимает список словарей и значение `state` (по умолчанию — `'EXECUTED'`). Она возвращает новый список, содержащий только те записи, у которых поле `state` соответствует заданному значению.

  
## Команды Git для работы над проектом

### Добавление изменений

```bash
git add .
```

### Коммит изменений

```bash
git commit -m "Описание коммита"
```

### Отправка изменений на GitHub

```bash
git push origin <имя ветки>

## Тестирование

Проект включает следующие модули и функции, для которых проведено тестирование:

### Модуль `masks`
#### Функция `get_mask_card_number`
- Проверка правильности маскирования номера карты.
- Тесты на различных входных форматах номеров карт, включая:
  - Граничные случаи.
  - Нестандартные длины номеров карт.
- Проверка корректной обработки строк, где отсутствует номер карты.

#### Функция `get_mask_account`
- Проверка правильности маскирования номера счета.
- Тесты с различными форматами и длинами номеров счетов.
- Проверка работы функции с входными данными, где номер счета меньше ожидаемой длины.

### Модуль `widget`
#### Функция `mask_account_card`
- Проверка распознавания и применения нужного типа маскировки (карта или счет).
- Параметризованные тесты с различными типами карт и счетов для проверки универсальности функции.
- Тестирование устойчивости функции к некорректным входным данным.

#### Функция `get_data`
- Проверка правильности преобразования дат.
- Тесты на различных входных форматах даты, включая граничные случаи и нестандартные строки с датами.
- Проверка обработки строк, где дата отсутствует.

### Модуль `processing`
#### Функция `filter_by_state`
- Тестирование фильтрации списка словарей по заданному статусу `state`.
- Проверка работы функции при отсутствии записей с указанным статусом `state`.
- Параметризация тестов для различных значений `state`.

#### Функция `sort_by_date`
- Проверка сортировки списка словарей по датам:
  - В порядке убывания.
  - В порядке возрастания.
- Тесты на корректность сортировки при одинаковых датах.
- Проверка работы функции с некорректными или нестандартными форматами дат.

### Общие аспекты тестирования
- **Фикстуры**: Созданы для предоставления тестовых данных, включая списки словарей с различными комбинациями `state` и `date`.
- **Покрытие тестами**: Добились покрытия тестами более 80% кода.
- **Параметризация**: Применяется для проверки функций с различными входными данными, чтобы избежать дублирования кода.
- **Тестирование исключений**: Все возможные ветви кода и исключения проверены.

### Использование тестов
Для запуска тестов выполните команду:
```bash
pytest --cov=имя_проекта

# Описание проекта

Проект включает несколько функций для работы с транзакциями и генерацией данных, а также тесты для проверки их корректности. Тесты написаны с использованием `pytest`.

## Описание функций

### `filter_by_currency(transactions: List[Dict[str, Any]], currency: str) -> Iterator[Dict[str, Any]]`
Фильтрует транзакции по указанной валюте.

- **Входные данные:**
  - `transactions` — список словарей, представляющих транзакции.
  - `currency` — строка с кодом валюты (например, "USD").
- **Выходные данные:** 
  - Итератор словарей, содержащих только транзакции с указанной валютой.

### `transaction_descriptions(transactions: List[Dict[str, Any]]) -> Iterator[str]`
Возвращает описания транзакций.

- **Входные данные:**
  - `transactions` — список словарей, представляющих транзакции.
- **Выходные данные:** 
  - Итератор строк, содержащих описание каждой операции.

### `card_number_generator(start: int, end: int) -> Iterator[str]`
Генерирует номера банковских карт в формате `XXXX XXXX XXXX XXXX`.

- **Входные данные:**
  - `start` — начальное число для генерации.
  - `end` — конечное число для генерации.
- **Выходные данные:**
  - Итератор строк, содержащих номера карт.

## Тесты

### Общие сведения
Для проверки функций используются тесты с `pytest`. Подключены фикстуры для упрощения тестирования, а также параметризация для проверки различных сценариев.

### Описание тестов

#### `test_filter_by_currency`
Тестирует функцию `filter_by_currency` на корректную фильтрацию транзакций по валюте.

- **Используемая фикстура:** `sample_transactions` (список тестовых транзакций).
- **Параметры:**
  - Проверяется фильтрация по разным валютам (`USD`, `EUR`, `RUB`) и случай, когда транзакции с заданной валютой отсутствуют.

#### `test_transaction_descriptions`
Тестирует функцию `transaction_descriptions` на корректное извлечение описаний транзакций.

- **Используемая фикстура:** `sample_transactions`.
- **Проверяется:** 
  - Возвращение всех описаний транзакций в правильном порядке.

#### `test_card_number_generator`
Тестирует функцию `card_number_generator`.

- **Параметры:**
  - Генерация последовательностей карт для различных диапазонов.
  - Проверка формата номеров карт (16 символов, разделение пробелами).
  - Граничные случаи (диапазоны `0..0`, `9999..10002`).

#### `test_card_number_generator_invalid_range`
Тестирует функцию `card_number_generator` на обработку некорректных диапазонов.

- **Проверяется:**
  - Пустой результат при некорректных входных данных (например, `start > end`).

## Пример входных данных

Пример транзакций, которые можно использовать для тестирования функций:

```python
transactions = [
    {
        "id": 939719570,
        "state": "EXECUTED",
        "date": "2018-06-30T02:08:58.425572",
        "operationAmount": {
            "amount": "9824.07",
            "currency": {
                "name": "USD",
                "code": "USD"
            }
        },
        "description": "Перевод организации",
        "from": "Счет 75106830613657916952",
        "to": "Счет 11776614605963066702"
    },
    {
        "id": 142264268,
        "state": "EXECUTED",
        "date": "2019-04-04T23:20:05.206878",
        "operationAmount": {
            "amount": "79114.93",
            "currency": {
                "name": "USD",
                "code": "USD"
            }
        },
        "description": "Перевод со счета на счет",
        "from": "Счет 19708645243227258542",
        "to": "Счет 75651667383060284188"
    },
    {
        "id": 873106923,
        "state": "EXECUTED",
        "date": "2019-03-23T01:09:46.296404",
        "operationAmount": {
            "amount": "43318.34",
            "currency": {
                "name": "руб.",
                "code": "RUB"
            }
        },
        "description": "Перевод со счета на счет",
        "from": "Счет 44812258784861134719",
        "to": "Счет 74489636417521191160"
    },
    {
        "id": 895315941,
        "state": "EXECUTED",
        "date": "2018-08-19T04:27:37.904916",
        "operationAmount": {
            "amount": "56883.54",
            "currency": {
                "name": "USD",
                "code": "USD"
            }
        },
        "description": "Перевод с карты на карту",
        "from": "Visa Classic 6831982476737658",
        "to": "Visa Platinum 8990922113665229"
    },
    {
        "id": 594226727,
        "state": "CANCELED",
        "date": "2018-09-12T21:27:25.241689",
        "operationAmount": {
            "amount": "67314.70",
            "currency": {
                "name": "руб.",
                "code": "RUB"
            }
        },
        "description": "Перевод организации",
        "from": "Visa Platinum 1246377376343588",
        "to": "Счет 14211924144426031657"
    }
]
# Декоратор для логирования выполнения функций

Этот проект включает декоратор `log`, который используется для логирования выполнения функций. Он записывает в лог информацию о начале и завершении работы функции, а также о её результатах или ошибках.

## Описание декоратора

### Декоратор `log`

Декоратор `log` логирует выполнение функции, включая:
- Успешное выполнение и результат функции.
- Ошибки и информацию о возникших исключениях.

#### Аргументы:
- `filename` (необязательный аргумент): Путь к файлу для записи логов. Если параметр не передан, лог будет выведен в консоль.

#### Пример использования:

```python
from src.decorators import log

@log(filename="mylog.txt")
def add(x: int, y: int) -> int:
    return x + y

add(2, 3)
Если передан параметр filename, логи будут записаны в указанный файл: add ok. Result: 5
Если произошла ошибка: add error: ZeroDivisionError. Inputs: (10, 0), {}


# Новая функциональность: Чтение финансовых операций из файлов

В рамках проекта добавлены функции для чтения финансовых операций из файлов CSV и Excel. Эти функции позволяют считывать данные из указанных файлов и возвращать их в виде списка словарей, где каждый словарь представляет одну транзакцию.

## Функции

### 1. `read_transactions_from_csv(file_path: str) -> List[Dict[str, any]]`

#### Описание:
Считывает финансовые операции из CSV-файла.

#### Параметры:

- `file_path` (str): Путь к CSV-файлу.

#### Возвращает:
Список словарей, где каждый словарь представляет одну транзакцию.

#### Обработка ошибок:
Если файл не найден или формат некорректен, выводится сообщение об ошибке, и функция возвращает пустой список.

---

### 2. `read_transactions_from_excel(file_path: str) -> List[Dict[str, any]]`

#### Описание:
Считывает финансовые операции из Excel-файла.

#### Параметры:

- `file_path` (str): Путь к Excel-файлу.

#### Возвращает:
Список словарей, где каждый словарь представляет одну транзакцию.

#### Обработка ошибок:
Если файл не найден или формат некорректен, выводится сообщение об ошибке, и функция возвращает пустой список.

## Тестирование

Для обеих функций написаны тесты, которые проверяют:

- Корректное чтение данных из файлов.
- Обработку ошибок, если файл не найден или формат некорректен.

Тесты используют библиотеку `pytest` и модуль `unittest.mock` для имитации работы с файлами.

## Примечания

- Функции используют библиотеку `pandas` для работы с данными.
- Для чтения Excel-файлов требуется установленная библиотека `openpyxl`.

## Зависимости

Для работы функций и тестов необходимо установить следующие библиотеки:

```bash
pip install pandas openpyxl pytest pytest-cov
